<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ê°„ë‹¨ ê²Œì‹œíŒ</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", Arial, sans-serif; margin: 0; background: #0b0f14; color: #e8eef6; }
    .wrap { max-width: 760px; margin: 0 auto; padding: 24px; }
    .card { background: #111826; border: 1px solid #263248; border-radius: 16px; padding: 16px; }
    h1 { margin: 0 0 10px; font-size: 22px; }
    .hint { margin: 6px 0 0; color: #9fb3d3; font-size: 13px; line-height: 1.5; }

    label { display: block; margin: 12px 0 6px; color: #c9d6ea; font-size: 14px; }
    input, textarea {
      width: 100%; box-sizing: border-box;
      padding: 12px; border-radius: 12px;
      border: 1px solid #2b3a55; background: #0b1220; color: #e8eef6;
      outline: none;
    }
    input:focus, textarea:focus { border-color: #6aa8ff; }
    textarea { min-height: 120px; resize: vertical; }

    .row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    button {
      padding: 12px 14px; border-radius: 12px;
      border: 1px solid #2b3a55; background: #15223a; color: #e8eef6;
      cursor: pointer;
    }
    button.primary { background: #2a6fff; border-color: #2a6fff; color: white; }
    button.danger { background: #2a1520; border-color: #5a2a3a; }
    button:disabled { opacity: .5; cursor: not-allowed; }

    .posts { margin-top: 14px; display: grid; gap: 12px; }
    .post { background: #111826; border: 1px solid #263248; border-radius: 16px; padding: 14px; }
    .meta { display: flex; justify-content: space-between; gap: 10px; flex-wrap: wrap; color: #9fb3d3; font-size: 12px; margin-top: 6px; }
    .post h3 { margin: 0; font-size: 18px; }
    .post p { margin: 10px 0 0; color: #cfe0ff; line-height: 1.6; white-space: pre-wrap; }
    .empty { margin-top: 14px; color: #9fb3d3; font-size: 14px; }
    .footer { margin-top: 14px; color: #9fb3d3; font-size: 12px; }
    a { color: #cfe0ff; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ğŸ“Œ ê°„ë‹¨ ê²Œì‹œíŒ</h1>
      <p class="hint">
        ì´ ê²Œì‹œíŒì€ <b>ì„œë²„ ì—†ì´</b> ë™ì‘í•©ë‹ˆë‹¤. ê¸€ì€ ì´ ë¸Œë¼ìš°ì €ì˜ ì €ì¥ê³µê°„(<b>localStorage</b>)ì— ì €ì¥ë¼ìš”.
        ë‹¤ë¥¸ PC/íœ´ëŒ€í°ì—ì„œëŠ” ê³µìœ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </p>

      <label for="title">ì œëª©</label>
      <input id="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="60" />

      <label for="content">ë‚´ìš©</label>
      <textarea id="content" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>

      <div class="row">
        <button class="primary" id="btnAdd">ê²Œì‹œë¬¼ ì˜¬ë¦¬ê¸°</button>
        <button id="btnClearInputs">ì…ë ¥ ì§€ìš°ê¸°</button>
        <button class="danger" id="btnClearAll" title="ì €ì¥ëœ ê¸€ì„ ì „ë¶€ ì‚­ì œí•©ë‹ˆë‹¤.">ì „ì²´ ì‚­ì œ</button>
      </div>
    </div>

    <div id="posts" class="posts"></div>
    <div id="empty" class="empty" style="display:none;">ì•„ì§ ê²Œì‹œë¬¼ì´ ì—†ì–´ìš”. ì²« ê¸€ì„ ì˜¬ë ¤ë³´ì„¸ìš” ğŸ™‚</div>

    <div class="footer">
      GitHub Pages URL ì˜ˆì‹œ: <span id="urlHint"></span>
    </div>
  </div>

  <script>
    const KEY = "simple_posts_v1";

    const $title = document.getElementById("title");
    const $content = document.getElementById("content");
    const $posts = document.getElementById("posts");
    const $empty = document.getElementById("empty");

    document.getElementById("urlHint").textContent = location.href;

    function nowKSTString() {
      // ë¸Œë¼ìš°ì € ì‹œê°„ ê¸°ì¤€ í‘œì‹œ(ëŒ€ë¶€ë¶„ KST)
      const d = new Date();
      const pad = (n) => String(n).padStart(2, "0");
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
    }

    function loadPosts() {
      try {
        return JSON.parse(localStorage.getItem(KEY) || "[]");
      } catch {
        return [];
      }
    }

    function savePosts(posts) {
      localStorage.setItem(KEY, JSON.stringify(posts));
    }

    function escapeHtml(s) {
      return s.replace(/[&<>"']/g, (c) => ({
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      }[c]));
    }

    function render() {
      const posts = loadPosts();
      $posts.innerHTML = "";

      if (posts.length === 0) {
        $empty.style.display = "block";
        return;
      }
      $empty.style.display = "none";

      posts.forEach((p, idx) => {
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = `
          <h3>${escapeHtml(p.title)}</h3>
          <div class="meta">
            <span>ì‘ì„±: ${escapeHtml(p.createdAt)}</span>
            <span>#${posts.length - idx}</span>
          </div>
          <p>${escapeHtml(p.content)}</p>
          <div class="row" style="margin-top:12px;">
            <button data-action="edit" data-idx="${idx}">ìˆ˜ì •</button>
            <button class="danger" data-action="delete" data-idx="${idx}">ì‚­ì œ</button>
          </div>
        `;
        $posts.appendChild(div);
      });
    }

    function addPost() {
      const title = $title.value.trim();
      const content = $content.value.trim();

      if (!title || !content) {
        alert("ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”!");
        return;
      }

      const posts = loadPosts();
      posts.unshift({
        title,
        content,
        createdAt: nowKSTString()
      });
      savePosts(posts);

      $title.value = "";
      $content.value = "";
      render();
    }

    function clearInputs() {
      $title.value = "";
      $content.value = "";
      $title.focus();
    }

    function clearAll() {
      if (!confirm("ì €ì¥ëœ ê²Œì‹œë¬¼ì„ ì „ë¶€ ì‚­ì œí• ê¹Œìš”?")) return;
      localStorage.removeItem(KEY);
      render();
    }

    function deletePost(idx) {
      const posts = loadPosts();
      posts.splice(idx, 1);
      savePosts(posts);
      render();
    }

    function editPost(idx) {
      const posts = loadPosts();
      const p = posts[idx];
      const newTitle = prompt("ì œëª© ìˆ˜ì •", p.title);
      if (newTitle === null) return;

      const newContent = prompt("ë‚´ìš© ìˆ˜ì •", p.content);
      if (newContent === null) return;

      p.title = newTitle.trim() || p.title;
      p.content = newContent.trim() || p.content;
      savePosts(posts);
      render();
    }

    document.getElementById("btnAdd").addEventListener("click", addPost);
    document.getElementById("btnClearInputs").addEventListener("click", clearInputs);
    document.getElementById("btnClearAll").addEventListener("click", clearAll);

    // ì¹´ë“œ ë‚´ Enter ì²˜ë¦¬: ì œëª©ì—ì„œ Enter ëˆ„ë¥´ë©´ ë‚´ìš©ìœ¼ë¡œ, Ctrl+EnterëŠ” ì—…ë¡œë“œ
    $title.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        $content.focus();
      }
    });
    $content.addEventListener("keydown", (e) => {
      if (e.key === "Enter" && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        addPost();
      }
    });

    // ê²Œì‹œë¬¼ ë²„íŠ¼ë“¤(ìˆ˜ì •/ì‚­ì œ) ì´ë²¤íŠ¸ ìœ„ì„
    $posts.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-action]");
      if (!btn) return;
      const action = btn.dataset.action;
      const idx = Number(btn.dataset.idx);

      if (action === "delete") {
        if (!confirm("ì´ ê¸€ì„ ì‚­ì œí• ê¹Œìš”?")) return;
        deletePost(idx);
      } else if (action === "edit") {
        editPost(idx);
      }
    });

    render();
  </script>
</body>
</html>
